<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="algolia-site-verification" content="24E3347A9759430F" />
    <!-- <base href="/"> -->

    <title>Compendium Viewer</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <!-- 
      Security Note: External CDN resources should use Subresource Integrity (SRI) hashes
      to prevent tampering. Consider self-hosting these assets or adding SRI attributes.
      Example: <script src="..." integrity="sha384-..." crossorigin="anonymous"></script>
    -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic@1" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uswds/3.12.0/css/uswds.min.css">
    <link rel="stylesheet" href="style.css">

  </head>

  <body>

    <!-- Skip Navigation Link for Accessibility -->
    <a href="#chapter-content" class="usa-skipnav">Skip to main content</a>

    <div class="grid-container">

      <header class="header">
        <div class="usa-overlay"></div>
        <header class="usa-header usa-header--basic">

          <div class="usa-nav-container">
            <div class="usa-navbar">
              <div class="usa-logo">
                <em class="usa-logo__text">
                  <a href="/" title="Compendium Viewer Home">
                    <span class="logo-main">U.S. Copyright Office</span>
                    <span class="logo-sub">Compendium of Practices</span>
                  </a>
                </em>
              </div>

              <!-- Chapters Dropdown (moved from mobile menu) -->
              <div class="navbar-controls">
                <!-- Translation Controls (Moved here from mobile menu) -->
                <div id="translation-controls-wrapper" style="display: none;">
                  <div class="translation-controls">
                    <!-- Label removed per plan, icon moved to button -->
                    <div class="translation-controls-row">
                      <select id="language-select" class="usa-select translation-select"
                        aria-label="Select translation language">
                        <option value="">English (Original)</option>
                        <option value="es">Español (Spanish)</option>
                        <option value="zh">中文 (Chinese)</option>
                        <option value="fr">Français (French)</option>
                        <option value="de">Deutsch (German)</option>
                        <option value="ja">日本語 (Japanese)</option>
                        <option value="ko">한국어 (Korean)</option>
                        <option value="ru">Русский (Russian)</option>
                        <option value="ar">العربية (Arabic)</option>
                        <option value="pt">Português (Portuguese)</option>
                        <option value="it">Italiano (Italian)</option>
                        <option value="hi">हिन्दी (Hindi)</option>
                        <option value="vi">Tiếng Việt (Vietnamese)</option>
                      </select>
                      <button type="button" id="translate-button"
                        class="usa-button usa-button--outline translate-button hidden"
                        aria-label="Translate current chapter">
                        <svg class="usa-icon" aria-hidden="true" focusable="false" role="img"
                          style="margin-right: 0.25rem;">
                          <use xlink:href="/assets/img/sprite.svg#language"></use>
                        </svg>
                        Translate
                      </button>
                    </div>
                    <!-- Clear button might need better placement or styling in header context, keeping it inside for now -->
                    <button type="button" id="clear-translations-button"
                      class="usa-button usa-button--unstyled clear-translations-button"
                      aria-label="Clear all cached translations" style="display: none;">
                      <!-- Hidden by default, script shows it -->
                      Clear cached translations
                    </button>
                  </div>
                </div>


                <!-- Version Display (moved from mobile menu) -->
                <div id="version-display" class="version-display" tabindex="0" aria-label="About this site">
                  v<span id="version-number"></span>
                  <div class="version-tooltip" role="tooltip">
                    <h3 class="version-tooltip__title">About the Copyright Compendium Viewer</h3>
                    <p>This site provides a navigable, searchable web display of the U.S. Copyright Office's
                      <em>Compendium of U.S. Copyright Office Practices</em>, Third Edition. The Compendium is the
                      administrative manual of the Register of Copyrights and provides expert guidance to copyright
                      applicants, practitioners, scholars, the courts, and the general public regarding copyright law
                      and institutional practices.
                    </p>
                    <p class="version-tooltip__note">This is an <strong>experimental transformation</strong> of the
                      official Copyright Compendium from PDF format to HTML for web display.</p>
                  </div>
                </div>
              </div>

              <!-- Chapter Title Display in Header (kept for mobile) -->
              <div id="header-chapter-title" class="header-chapter-title"></div>

              <button type="button" class="usa-menu-btn">Menu</button>
            </div>
            <nav aria-label="Primary navigation" class="usa-nav">
              <button type="button" class="usa-nav__close" aria-label="Close menu">
                <img src="/assets/img/usa-icons/close.svg" alt="" aria-hidden="true" />
              </button>
              <!-- **** ADD usa-accordion class here **** -->
              <ul class="usa-nav__primary usa-accordion">
                <li class="usa-nav__primary-item">
                  <section aria-label="Search component" id="search-component-wrapper">
                    <div id="autocomplete-search"></div>
                  </section>
                </li>
                <li class="usa-nav__primary-item">
                  <button type="button" class="usa-accordion__button usa-nav__link" aria-expanded="false"
                    aria-controls="basic-nav-section-one">
                    <span>Chapters</span>
                  </button>
                  <ul id="basic-nav-section-one" class="usa-nav__submenu" hidden aria-label="Available chapters">
                    <!-- Chapter list will be populated here -->
                  </ul>
                </li>

            </nav>
          </div>
        </header>
      </header>

      <div class="translation-wrapper">
        <!-- Translation Disclaimer Banner (only shown when translation is active) -->
        <div id="translation-disclaimer" class="usa-alert usa-alert--warning usa-alert--slim" role="alert"
          style="display: none;">
          <div class="usa-alert__body">
            <p class="usa-alert__text">
              <strong>⚠️ Experimental Translation:</strong> Any language other than English represents automatically
              translated text and is not official.
              The translation may contain inaccuracies or errors. For authoritative information, please refer to the
              <a href="#" id="view-original-link" class="usa-link">original English version</a>.
            </p>
          </div>
        </div>

        <!-- Translation Progress Indicator (only shown during translation) -->
        <div id="translation-progress" class="translation-progress" role="status" aria-live="polite"
          style="display: none;">
          <div class="translation-progress__content">
            <div class="translation-progress__spinner">
              <svg class="translation-progress__spinner-svg" viewBox="0 0 50 50" aria-hidden="true">
                <circle class="translation-progress__spinner-circle" cx="25" cy="25" r="20" fill="none" stroke-width="4">
                </circle>
              </svg>
              <div class="translation-progress__spinner-text" aria-hidden="true">
                <span id="translation-progress-letters">...</span>
              </div>
            </div>
            <div class="translation-progress__info">
              <div class="translation-progress__status" id="translation-progress-status">Preparing translation...</div>
              <div class="translation-progress__bar-container">
                <div class="translation-progress__bar" id="translation-progress-bar" role="progressbar" aria-valuenow="0"
                  aria-valuemin="0" aria-valuemax="100">
                  <div class="translation-progress__bar-fill" id="translation-progress-bar-fill"></div>
                </div>
              </div>
              <div class="translation-progress__details" id="translation-progress-details"></div>
            </div>
          </div>
        </div>
      </div>

      <nav class="sidenav" aria-label="Side navigation">
        <div id="section-list">
          <!-- Hierarchical Section list will be populated here -->
        </div>
      </nav>

      <main class="content" id="chapter-content">
        <!-- Chapter content will be loaded here -->
        <p>Loading content...</p>
      </main>

    </div> <!-- End grid-container -->
    <!-- Algolia Search Client -->
    <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>

    <!-- Algolia Autocomplete Core -->
    <script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js@1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uswds/3.12.0/js/uswds-init.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uswds/3.12.0/js/uswds.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js"></script>
    <script type="module" src="script.ts" defer></script>
  </body>

</html>